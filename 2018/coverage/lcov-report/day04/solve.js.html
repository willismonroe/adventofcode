<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for day04/solve.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">All files</a> / <a href="index.html">day04</a> solve.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">95.52% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>64/67</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">92.31% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>12/13</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">94.12% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>16/17</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">95.16% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>59/62</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1130x</span>
<span class="cline-any cline-yes">1130x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">404711x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-yes">13300x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-yes">11146x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-yes">2292x</span>
<span class="cline-any cline-yes">2292x</span>
<span class="cline-any cline-yes">2292x</span>
<span class="cline-any cline-yes">2292x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2292x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">588x</span>
<span class="cline-any cline-yes">588x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">558x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">508x</span>
<span class="cline-any cline-yes">508x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50x</span>
<span class="cline-any cline-yes">46x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">588x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-yes">13300x</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">852x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">77x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">415x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">25x</span>
<span class="cline-any cline-yes">22x</span>
<span class="cline-any cline-yes">5091x</span>
<span class="cline-any cline-yes">22x</span>
<span class="cline-any cline-yes">22x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">79x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">const fs = require("fs");
&nbsp;
const input = fs
  .readFileSync(__dirname + "/input.txt")
  .toString()
  .split("\n")
  .map(s =&gt; s.replace(/\r$/, ""))
  .filter(s =&gt; s.length &gt; 0);
&nbsp;
function count(input) {
  return [...new Set(input)].map(x =&gt; [x, input.filter(y =&gt; y === x).length]);
}
&nbsp;
function range(start, end) {
  let ret = [];
  for (let i = start; i &lt;= end; i++) {
    ret.push(i);
  }
  return ret;
}
&nbsp;
function sortDate(input) {
  input.sort((a, b) =&gt; {
    return new Date(a.slice(1, 17)) - new Date(b.slice(1, 17));
  });
  return input;
}
&nbsp;
function createBarracks(input) {
  input = sortDate(input);
&nbsp;
  let barracks = { guards: {} };
&nbsp;
  let guard = {};
&nbsp;
  let guardRe = /Guard #(\d{1,4})/;
&nbsp;
  for (let line of input) {
    let [timeStamp, action] = line.split("] ");
    let timeRe = /\d{4}-(\d{2})-(\d{2}) \d{2}:(\d{2})/;
    let result = timeRe.exec(timeStamp);
    let [month, day, minute] = [result[1], result[2], result[3]];
&nbsp;
    switch (action.slice(0, 5)) {
      case "Guard":
        let id = guardRe.exec(action)[1];
        if (id === guard.id) {
          // console.log("Same guard");
        } else if (Object.keys(barracks.guards).includes(id)) {
          // console.log("Repeat guard");
          barracks.guards[guard.id] = guard;
          guard = barracks.guards[id];
        } else {
          if (guard.id) {
            barracks.guards[guard.id] = guard;
          }
          guard = { id: id, sleep: [] };
          // console.log(`New Guard ID: ${guard.id}`);
        }
        break;
      case "falls":
        guard.falls = minute;
        break;
      case "wakes":
        guard.wakes = minute;
        let asleep = range(guard.falls, guard.wakes - 1);
        asleep.forEach(item =&gt; guard.sleep.push(Number(item)));
        guard.falls = null;
        guard.wakes = null;
        // console.log(`Slept for: ${asleep.length} minutes`);
        break;
    }
  }
  return barracks;
}
&nbsp;
function partA(input) {
  let barracks = createBarracks(input);
  let sleepiest = Object.keys(barracks.guards).sort((guardA, guardB) =&gt; {
    return (
      barracks.guards[guardB].sleep.length -
      barracks.guards[guardA].sleep.length
    );
  })[0];
  let minutes = count(barracks.guards[sleepiest].sleep);
  minutes = minutes.sort((a, b) =&gt; b[1] - a[1]);
&nbsp;
  return minutes[0][0] * sleepiest;
}
&nbsp;
function partB(input) {
  let barracks = createBarracks(input);
&nbsp;
  for (let guard in barracks.guards) {
    if (barracks.guards[guard].sleep.length &gt; 0) {
      let minutes = count(barracks.guards[guard].sleep);
      minutes = minutes.sort((a, b) =&gt; b[1] - a[1]);
      let minute = minutes[0];
      barracks.guards[guard].sleepiestMinute = minute;
    } else {
      barracks.guards[guard].sleepiestMinute = [0, 0];
    }
  }
  let sleepiest = Object.keys(barracks.guards).sort((guardA, guardB) =&gt; {
    return (
      barracks.guards[guardB].sleepiestMinute[1] -
      barracks.guards[guardA].sleepiestMinute[1]
    );
  })[0];
  return barracks.guards[sleepiest].sleepiestMinute[0] * sleepiest;
}
&nbsp;
function <span class="fstat-no" title="function not covered" >solve(</span>) {
<span class="cstat-no" title="statement not covered" >  console.log(`Part A: ${partA(input)}`);</span>
<span class="cstat-no" title="statement not covered" >  console.log(`Part B: ${partB(input)}`);</span>
}
&nbsp;
<span class="missing-if-branch" title="if path not taken" >I</span>if (require.main === module) {
<span class="cstat-no" title="statement not covered" >  solve();</span>
}
&nbsp;
module.exports = { partA: partA, partB: partB };
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Wed Dec 05 2018 14:16:57 GMT-0800 (Pacific Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
